<div class="row vertical-space-bottom-20">
  <div class="col-xs-12">
    <h3>{{request.model.biblio.title}}</h3>
    <div class="author">{{request.model.biblio.author}}</div>
  </div>
</div>

{{#if request.model.biblio.subscriptions}}
  <nav>
    <ul class="nav nav-tabs" role="tablist">
      <li role="presentation" class="{{is-active-tab 'tab1' activeTab}}"><a href="#items" data-toggle="tab" onclick={{action "setActiveTab" "tab1"}}>Exemplar ({{itemsAvailable.length}})</a></li>
      <li role="presentation" class="{{is-active-tab 'tab2' activeTab}}"><a href="#subscriptions" data-toggle="tab" onclick={{action "setActiveTab" "tab2"}}>Bestånd ({{request.model.biblio.subscriptions.length}})</a></li>
    </ul>
  </nav>

  <!-- Tab panes -->
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane {{is-active-tab 'tab1' activeTab}}" id="items" >
      {{item-table items=itemsAvailable hasSubscription=true setItemToOrder=(action "setItemToOrder")}}
    </div>
    <div role="tabpanel" class="tab-pane {{is-active-tab 'tab2' activeTab}}" id="subscriptions">
      <div class="row">
        <div class="col-xs-12">
          <div class="table-responsive">
            <table class="table table-subscriptions">
              <thead>
                <tr>
                  <th>Placering</th>
                  <th>Notering</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                {{#each request.model.biblio.subscriptions as |subscription|}}
                <tr>
                  <td>{{subscription.sublocation.name}}</td>
                  <td><textarea class="subscription-note" readonly wrap=off>{{subscription.publicNote}}</textarea></td>
                  <td><button class="btn btn-primary btn-block" {{action 'setSubscriptionToOrder' subscription}}>Välj</button></td>
                </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

{{else}}
  <nav>
    <ul class="nav nav-tabs" role="tablist">
      <li role="presentation" class="{{is-active-tab 'tab1' activeTab}}"><a href="#items" data-toggle="tab" onclick={{action "setActiveTab" "tab1"}}>Tillgängliga ({{itemsAvailable.length}})</a></li>
      <li role="presentation" class="{{is-active-tab 'tab2' activeTab}}"><a href="#item-queue" data-toggle="tab" onclick={{action "setActiveTab" "tab2"}}>Utlånade ({{itemsNotAvailable.length}})</a></li>
    </ul>
  </nav>
  <!-- Tab panes -->
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane {{is-active-tab 'tab1' activeTab}}" id="items" >
      {{item-table items=itemsAvailable setItemToOrder=(action "setItemToOrder")}}
    </div>
    <div role="tabpanel" class="tab-pane {{is-active-tab 'tab2' activeTab}}" id="item-queue">    
  
      {{#if request.model.biblio.canBeQueued}}
      <div class="row">
        <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-body center">
            <strong>{{request.model.biblio.noInQueue}} personer i kö på utlånade exemplar</strong> <button class="btn btn-primary" {{action 'setItemToOrder' null}}>Ställ dig i kö</button>
          </div>
        </div>
        
        </div>
      </div>
      {{/if}}
      <div class="row">
        <div class="col-xs-12">
          {{item-table items=itemsNotAvailable setItemToOrder=(action "setItemToOrder")}}
        </div>
      </div>
    </div>
  </div>
{{/if}}